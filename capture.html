<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta content="stuff, to, help, search, engines, not" name="keywords">
        <meta content="What this page is about." name="description">
        <title>Display Webcam Stream</title>

        <style>
            #container {
                margin: 0px auto;
                width: 500px;
                height: 375px;
                border: 10px #333 solid;
            }
            #videoElement {
                width: 500px;
                height: 375px;
                background-color: #666;
            }
        </style>

        <script src="js/jquery-3.1.1.min.js"></script>
        <script>
            $(document).ready(function () {

                var video = document.querySelector("#videoElement");
                var uploadURL = "http://toinsson.pythonanywhere.com/upload";
                navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia;

                if (navigator.getUserMedia) {
                    navigator.getUserMedia({video: true}, handleVideo, videoError);
                }

                function handleVideo(stream) {
                    video.src = window.URL.createObjectURL(stream);
                }

                function videoError(e) {
                    // do something
                }

                var canvas = document.createElement('canvas');
                canvas.width = 1024;
                canvas.height = 768;
                var ctx = canvas.getContext('2d');

                function takePicture() {
                    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                }

                function uploadPicture() {
                    $.post(uploadURL,
                            {
                                img: canvas.toDataURL('image/jpeg')
                            },
                            function (data) {});
                }
                var takePicButton = document.getElementById('takeButton');
                var uploadPicButton = document.getElementById('uploadButton');
                takePicButton.addEventListener("click", takePicture);
                uploadPicButton.addEventListener("click", uploadPicture);
            });
        </script>
    </head>

    <body>
        <div id="container">
            <video autoplay="true" id="videoElement">

            </video>
        </div>
        <button id="takeButton">Take Picture</button>
        <button id="uploadButton">Upload Picture</button>
    </body>
</html>